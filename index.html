<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Cajafuerte</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
			crossorigin="anonymous"
		/>
	</head>
	<body>
		<header></header>
		<main>
			<div class="container">
				<div class="row vh-100 align-items-center justify-content-center">
					<div class="col-md-10 col-12">
						<form>
							<div class="row m-2 border p-3 shadow">
								<p class="fs-3 text-center">ALUMNO</p>
								<input
									type="email"
									class="form-control fs-3 text-center"
									id="exampleInputEmail1"
									aria-describedby="emailHelp"
									name="user"
									placeholder="alumno@fpllefia.com"
								/>
								
							</div>
							
							<div id="divValidacion" class="row m-2 border p-2 shadow">
								<p class="fs-1 text-center">Validación dígitos</p>
								
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/imagenes/profesores/foto2_carlos.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d1"
												name="pass"
											/>
											

										</div>
										</div>
								</div>
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/imagenes/profesores/patricia_salinas.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d2"
												name="pass"
											/>
											

										</div>
										</div>
								</div>
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/imagenes/profesores/jordi_egea.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d3"
												name="pass"
											/>
											

										</div>
										</div>
								</div>
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/imagenes/profesores/anna_rovira1.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d4"
												name="pass"
											/>
											

										</div>
										</div>
								</div>
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/2021/03/24/raul-2.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d5"
												name="pass"
											/>
											

										</div>
										</div>
								</div>
								<div class="col-4 col-lg-2">
									<div class="card mb-2" style="">
										<img src="https://fpllefia.com/images/imagenes/profesores/foto2_carlos.jpg" class="card-img-top" alt="...">
										<div class="card-body">
											<input
												type="text" maxlength="1" 
												class="form-control mb-3 fs-1 text-center p-0 digito"
												id="d6"
												name="pass"
												
											/>
											

										</div>
										</div>
								</div>	
								<div class="d-grid gap-2">
									
									<button id="validar" class="p-1 m-2 fs-3 btn btn-warning large-button " type="button">Validar dígitos</button>
										
								</div>
							</div>
								
							<div class="row m-2 border p-2 shadow">
								<div class="d-grid gap-2">
									<p class="fs-1 text-center">CÓDIGO DE LA CAJA FUERTE VIRTUAL</p>
									<input
										type="text"
										maxlength="6"
										class="form-control mb-3 fs-1 text-center p-0"
										id="pass"
										name="pass"
										placeholder="x x x x x x"
									/>
									<button id="enviar" class="p-5 fs-1 btn btn-success large-button " type="button">ENVIAR CÓDIGO</button>
										
								</div>
							</div>
						</form>
					</div>
					
				</div>
			</div>
		</main>
	</body>
    
	<script>
		const form = document.querySelector("form")
		const validar = document.querySelector("#validar")
		const enviar = document.querySelector("#enviar")

		validar.addEventListener("click", (e) => {
			console.log("validar");
			e.preventDefault();
			//console.log(form.user.value,form.pass.value);
		          //petición a la api
		          const peticionValidar = async ()=>{
                    user = form.user.value
                    pass = [
						document.querySelector('#d1').value+
						document.querySelector('#d2').value+
						document.querySelector('#d3').value+
						document.querySelector('#d4').value+
						document.querySelector('#d5').value+
						document.querySelector('#d6').value
					]
					
					console.log(pass);
                    const url = `http://localhost:8000/api/validar?user=${user}&pass=${pass}`
		            var respuesta = await fetch(url)
                    respuesta = await respuesta.json()
					if(respuesta.error == false){
						 document.querySelectorAll('.digito').forEach((elemento)=>{
							elemento.classList.add('bg-success');
						 })
					}
                    alert(respuesta.mensaje)
                    //pintaExamen(respuesta)
                  }
                  peticionValidar() 
		});
		enviar.addEventListener("click", (e) => {
			e.preventDefault();
			//console.log(form.user.value,form.pass.value);
		          //petición a la api
		          const peticionEnviar = async ()=>{
                    user = form.user.value
                    pass = document.querySelector('#pass').value;
					
                    const url = `http://localhost:8000/api/enviar?user=${user}&pass=${pass}`
		            var respuesta = await fetch(url)
                    respuesta = await respuesta.json()
                    alert(respuesta.mensaje)
                    //pintaExamen(respuesta)
                  }
                  peticionEnviar() 
		});
	</script>


</html>
